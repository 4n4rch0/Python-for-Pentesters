# @AUTHOR: 4N4NR0
# Finding subdomains used by the target organization is an effective way to increase the attack surface and discover more vulnerabilities.
# The script will use a list of potential subdomains and prepends them to the domain name provided via a command-line argument.
# The script then tries to connect to the subdomains and assumes the ones that accept the connection exist.

import requests 
import sys
import pyfiglet
from colorama import init, Fore, Back

def banner(titel):
    init()
    print(Fore.RED+"*"*73+Fore.RESET)
    print(23*"-"+"\tCREATED BY D3V1Lx0\t"+"-"*23)
    print(Back.BLACK+Fore.RED+pyfiglet.figlet_format(titel, font="poison")+Back.RESET+Fore.RESET)
    print(Fore.RED+"*"*73+Fore.RESET)

target_subomains = [
        "test", 
        "mail",
        "ftp",
        "www",
        "skype",
        "deklta1",
        "demo",
        "digital",
        "disocver",
        "elasticsearch",
        "enterprise",
        "erp",
        "energy",
        "os",
        "proxy",
        "payment",
        "apps",
        "myapps",
        "marketing",
        "sales",
        "hr",
        "finance",
        "sip",
        "error",
        "20"
        ]

banner("Sub3num")

try:

    for sub in target_subomains:
        target_domain = f"http://{sub}.{sys.argv[1]}"

        try:
            print(Fore.WHITE+f"[...] Requesting {target_domain}"+Fore.RESET)
            requests.get(target_domain)
            
        except requests.ConnectionError:
            print(Fore.RED+"[-] Domain unrechable: ",target_domain+Fore.RESET)
            pass
            
        else:
            print(Fore.GREEN+"[+] Valid domain: ",target_domain+Fore.RESET)
            
except KeyboardInterrupt:
    sys.exit()
    
except Exception as e:
    print(f"[ERROR]\t{e}")
    print("[USAGE]\tpython sub3num.py example.com")
    sys.exit()