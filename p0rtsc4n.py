# @AUTHOR: 4N4NR0

import sys
import socket
import pyfiglet
from colorama import init, Fore, Back

def banner(titel):
    init()
    print(Fore.RED+"*"*53+Fore.RESET)
    print(13*"-"+"\tCREATED BY D3V1Lx0\t"+"-"*13)
    print(Back.BLACK+Fore.RED+pyfiglet.figlet_format(titel, font="avatar")+Back.RESET+Fore.RESET)
    print(Fore.RED+"*"*53+Fore.RESET)

banner("   P0RTSC4N")

ip = input("[?] Target host/ip address: ")
print("\n"+"_"*53)

open_ports = [] 

ports = range(1, 65535)

def probe_port(ip, port, result = 1):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(0.5) 
        r = sock.connect_ex((ip, port))   
        if r == 0: 
            result = r 
        sock.close()

    except Exception as e:
        pass 

    return result

try:

    for port in ports:
        sys.stdout.flush() 
        response = probe_port(ip, port) 
        if response == 0:
            print(Fore.GREEN+f"[ + ] IP {ip}\tPORT {str(port)} - OPEN"+Fore.RESET)
            open_ports.append(port)
        else:
            print(Fore.RED+f"[ - ] IP {ip}\tPORT {str(port)} - CLOSED"+Fore.RESET)

    if open_ports: 
        print("[ + ] Open Ports: ")
        print(sorted(open_ports))
    else: 
        print("[ - ] No open ports discovered.")

except KeyboardInterrupt:
    sys.exit()

except Exception as e:
    print(f"[ERROR]\t{e}")